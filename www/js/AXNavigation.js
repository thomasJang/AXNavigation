var AXNavigation=function(){function a(a,b){var c=a;if(c)for(;function(){var a=!0;return b&&(a=b(c)),!a}();){if(!c.parentNode){c=!1;break}c=c.parentNode}return c}function b(){(function(){this.config={animateTime:300,addon_back:{html:'<i class="icon-dp-back"></i>'},toolbar_previous_title_show:!1},this.isCordova=window.cordova?!0:!1}).apply(this,arguments);var b=this,d=this.config;this.position=0,this.active_content_main="",this.content_tree={},this.animating=!1,this.aside_opend=!1,this.toolbar_status="",this.set_config=function(a,b){return $.extend(this.config,a,!0),this.device_width=$(document.body).width(),this},this.open_header=function(e,f,g,h,i){var j;if(d.tool_bar.find("#axn-navigation-"+e.objectName).get(0))j=d.tool_bar.find("#axn-navigation-"+e.objectName);else{var k=[];if(k.push('<div class="bar-wrapper" id="axn-navigation-'+e.objectName+'">'),e.header.title&&k.push('<div class="bar-title">'+e.header.title+"</div>"),"_right"==f&&(k.push('<div class="bar-addon left" data-header-btn="back">'+d.addon_back.html),d.toolbar_previous_title_show&&k.push('<span class="label">'+i.form.header.title+"</span>"),k.push("</div>")),e.header.addon)for(var l,m=0,n=e.header.addon.length;n>m;m++)l=e.header.addon[m],k.push('<div class="bar-addon '+l.type+'" data-header-btn="'+m+'">'+l.html+"</div>");k.push('<div style="clear: both;"></div>'),k.push("</div>"),d.tool_bar.append(k.join("")),j=d.tool_bar.find("#axn-navigation-"+e.objectName),h.header_jdom=j,h.header_jdom.find("[data-header-btn]").bind(c,function(c){var f=a(c.target,function(a){return null!=a.getAttribute("data-header-btn")});if(f&&!b.aside_opend){var g=f.getAttribute("data-header-btn");if("back"==g){var h={form:e};d.addon_back.onclick?d.addon_back.onclick.call(h,h):b.close(e)}else if(e.header.addon[g].onclick){var h={form:e,item:e.header.addon[g]};e.header.addon[g].onclick.call(h,h)}return!1}})}j.attr("class","bar-wrapper"),"_main"==f?j.addClass("fade-in"):"_right"==f?j.addClass("slide-in-right"):j.addClass("slide-in-"+g),i&&(i.header_jdom.attr("class","bar-wrapper"),i.header_jdom.addClass("slide-out-"+(g||"left")))},this.check_tool_tab_bar=function(a){if("undefined"!=typeof a.toolBar)if(a.toolBar){if(d.tool_bar.addClass("show"),"slide-up"==this.toolbar_status&&(d.tool_bar.removeClass("slide-out-up").addClass("slide-in-down"),this.toolbar_status=""),d.on_event){var b={action:"show_toolBar",form:a};d.on_event.call(b,b)}}else if(d.tool_bar.removeClass("show"),d.on_event){var b={action:"unshow_toolBar",form:a};d.on_event.call(b,b)}"undefined"!=typeof a.tabBar&&(a.tabBar?d.tab_bar.addClass("show"):d.tab_bar.removeClass("show"))},this.slide_up_toolbar=function(){this.toolbar_up_timer&&clearTimeout(this.toolbar_up_timer),this.toolbar_down_timer&&clearTimeout(this.toolbar_down_timer),"slide-up"!=this.toolbar_status&&(this.toolbar_up_timer=setTimeout(function(){d.tool_bar.removeClass("slide-in-down").addClass("slide-out-up")},d.animateTime),this.toolbar_status="slide-up")},this.slide_down_toolbar=function(){this.toolbar_up_timer&&clearTimeout(this.toolbar_up_timer),this.toolbar_down_timer&&clearTimeout(this.toolbar_down_timer),"slide-down"!=this.toolbar_status&&(d.tool_bar.removeClass("slide-out-up").addClass("slide-in-down"),this.toolbar_status="slide-down")},this.open=function(a,b,c){if(this.animating)return this;if(this.aside_opend)return this;var e,f,g;if("_main"==b&&this.active_content_main==a.objectName)return this;if("_right"==b&&(e=this.content_tree[this.active_content_main][this.content_tree[this.active_content_main].length-1],e.objectName==a.objectName))return this;this.check_tool_tab_bar(a),this.animating=!0;var h,i,j=!1;if(""==this.active_content_main&&"_main"!=b&&(b="_main"),"_main"==b?(""!=this.active_content_main&&this.content_tree[this.active_content_main].length>0&&(e=this.content_tree[this.active_content_main][this.content_tree[this.active_content_main].length-1],f="",f="fade"==c?"fade-out":"slide-out-"+(c||"left"),e.jdom.attr("class",d.content_wrapper_class_name+function(){return e.form.className?" "+e.form.className:""}()),e.jdom.addClass(f),e.header_jdom&&e.header_jdom.addClass(f),j=!0),"undefined"==typeof this.content_tree[a.objectName]?(h='<div class="'+d.content_wrapper_class_name+" "+(a.className||"")+'" id="axn-content-'+a.objectName+'" data-content-target="'+b+'"></div>',d.content_container.prepend(h),i=d.content_container.find("#axn-content-"+a.objectName),j&&i.addClass("fade-in"),g={form:a,jdom:i},a.header&&this.open_header(a,b,c,g,e),$.get(a.url,function(b){i.append(b),window[a.objectName]&&window[a.objectName][a.startFunction]()}),i.bind("scroll",function(b){if(d.on_scroll){var c={form:a,scroll_top:b.target.scrollTop};d.on_scroll.call(c,c)}})):(g=this.content_tree[a.objectName][0],g.jdom.attr("class",d.content_wrapper_class_name+function(){return a.className?" "+a.className:""}()),j&&g.jdom.addClass("fade-in"),a.header&&this.open_header(a,b,c,g,e),window[a.objectName]&&window[a.objectName].focus&&window[a.objectName].focus())):"_right"==b&&(h='<div class="'+d.content_wrapper_class_name+" "+(a.className||"")+'" id="axn-content-'+a.objectName+'" data-content-target="'+b+'"></div>',d.content_container.append(h),i=d.content_container.find("#axn-content-"+a.objectName),g={form:a,jdom:i},i.addClass("slide-in-right"),e=this.content_tree[this.active_content_main][this.content_tree[this.active_content_main].length-1],e.jdom.attr("class",d.content_wrapper_class_name+function(){return e.form.className?" "+e.form.className:""}()),e.jdom.addClass("slide-out-left"),e.header_jdom&&e.header_jdom.addClass("slide-out-left"),a.header&&this.open_header(a,b,!1,g,e),$.get(a.url,function(b){i.append(b),window[a.objectName]&&window[a.objectName][a.startFunction]()})),setTimeout(function(){if(this.animating=!1,"_main"==b){var c=this.content_tree[this.active_content_main];if(c&&c[0]){c[0].jdom.removeClass("fade-in");for(var d=1,e=c.length;e>d;d++)c[d].jdom.remove(),c[d].header_jdom&&c[d].header_jdom.remove(),window[c[d].form.objectName]&&delete window[c[d].form.objectName]}this.content_tree[a.objectName]=[g],this.active_content_main=a.objectName}else"_right"==b&&(g.jdom.removeClass("slide-in-right"),this.content_tree[this.active_content_main].push(g))}.bind(this),d.animateTime),d.on_event){var k={action:"open",form:a};d.on_event.call(k,k)}},this.close=function(){if(this.animating)return this;if(""==this.active_content_main)return this;this.animating=!0;var a=this.content_tree[this.active_content_main],b=a[a.length-2].form;this.check_tool_tab_bar(b),a[a.length-2].jdom.removeClass("slide-out-left").addClass("slide-in-left"),a[a.length-1].jdom.removeClass("slide-in-right").addClass("slide-out-right"),b.header&&(a[a.length-2].header_jdom.removeClass("slide-out-left").addClass("slide-in-left"),a[a.length-1].header_jdom.removeClass("slide-in-right").addClass("slide-out-right")),setTimeout(function(){a[a.length-2].jdom.removeClass("slide-in-left"),a[a.length-1].jdom.remove(),b.header&&(a[a.length-2].header_jdom.removeClass("slide-in-left"),a[a.length-1].header_jdom.remove()),a.pop(),window[b.objectName]&&delete window[b.objectName],this.animating=!1}.bind(this),d.animateTime)},this.remove_tree=function(a){for(var b=0,c=a.length;c>b;b++){var d=this.content_tree[a[b]];if(d)for(var e=0,f=d.length;f>e;e++)d[e].jdom.remove(),d[e].header_jdom&&d[e].header_jdom.remove(),window[d[e].form.objectName]&&delete window[d[e].form.objectName]}},this.scroll_top=function(a){if(this.animating)return this;if(""==this.active_content_main)return this;b.animating=!0;var c=this.content_tree[this.active_content_main],e=c[c.length-1].jdom;e.css({"-webkit-overflow-scrolling":"none",overflow:"hidden"}),e.stop().animate({scrollTop:a},d.animateTime,"swing",function(){b.animating=!1,e.css({"-webkit-overflow-scrolling":"touch",overflow:"auto"})})},this.open_aside=function(a){if(this.aside_opend=!0,this.app_mask=$('<div class="app-content-mask"></div>'),"aside_left"==a?(d.aside_left.show(),d.tool_bar.addClass("open-aside-left"),d.content_container.addClass("open-aside-left"),$(document.body).append(this.app_mask),this.app_mask.addClass("open-aside-left"),this.app_mask.bind(c,function(a){return b.close_aside("aside_left"),a.preventDefault(),a.stopPropagation(),!1})):"aside_right"==a&&(d.aside_right.show(),d.tool_bar.addClass("open-aside-right"),d.content_container.addClass("open-aside-right"),$(document.body).append(this.app_mask),this.app_mask.addClass("open-aside-right"),this.app_mask.bind(c,function(a){return b.close_aside("aside_right"),a.preventDefault(),a.stopPropagation(),!1})),d.tab_bar.addClass("slide-out-down"),d.on_event){var e={action:"open_aside",type:a};d.on_event.call(e,e)}},this.close_aside=function(a){if(d.tool_bar.removeClass("open-aside-left").removeClass("open-aside-right"),d.content_container.removeClass("open-aside-left").removeClass("open-aside-right"),"aside_left"==a?(d.tool_bar.addClass("close-aside-left"),d.content_container.addClass("close-aside-left"),this.app_mask.removeClass("open-aside-left").addClass("close-aside-left")):"aside_right"==a&&(d.tool_bar.addClass("close-aside-right"),d.content_container.addClass("close-aside-right"),this.app_mask.removeClass("open-aside-right").addClass("close-aside-right")),d.tab_bar.removeClass("slide-out-down").addClass("slide-in-up"),setTimeout(function(){d.aside_left.hide(),d.aside_right.hide(),this.app_mask.remove(),d.tool_bar.removeClass("close-aside-left").removeClass("close-aside-right"),d.content_container.removeClass("close-aside-left").removeClass("close-aside-right"),d.tab_bar.removeClass("slide-in-up"),this.aside_opend=!1}.bind(this),d.animateTime),d.on_event){var b={action:"close_aside",type:a};d.on_event.call(b,b)}},this.reload=function(){if(""==this.active_content_main)return this;var a=this.content_tree[this.active_content_main],b=a.length-1,c=a[b].form;window[a[b].form.objectName]&&delete window[a[b].form.objectName],jdom=d.content_container.find("#axn-content-"+c.objectName),jdom.empty(),$.get(c.url,function(a){jdom.append(a),window[c.objectName]&&window[c.objectName][c.startFunction]()})}}var c="ontouchstart"in window?"touchstart":"click";return b}();