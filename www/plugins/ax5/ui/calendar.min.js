!function(root,ax_super){var U=ax5.util,axd=ax5.dom,ax_class=function(){this.main=function(){ax_super&&ax_super.call(this),this.config={click_event_name:"ontouchstart"in document.documentElement?"touchstart":"click",theme:"default",mode:"day",item_width:50,item_height:50,item_padding:2,date_format:"yyyy-mm-dd",display_date:new Date}}.apply(this,arguments),this.target=null;var cfg=this.config;this.init=function(){cfg.target||U.error("aui_calendar_400","[ax5.ui.calendar] config.target is required"),this.target=ax5.dom(cfg.target),cfg.display_date=U.date(cfg.display_date),this.target.html(this.get_frame()),this.els={root:this.target.find('[data-calendar-els="root"]'),control:this.target.find('[data-calendar-els="control"]'),"control-display":this.target.find('[data-calendar-els="control-display"]'),body:this.target.find('[data-calendar-els="body"]')},cfg.control&&this.els.control.find("[data-calendar-move]").on(cfg.click_event_name,function(e){this.move(e||window.event)}.bind(this)),"day"==cfg.mode?this.print_day(cfg.display_date):"month"==cfg.mode||"year"==cfg.mode},this.get_frame=function(){var po=[];return po.push('<div class="ax5-ui-calendar '+cfg.theme+'" data-calendar-els="root" style="width:'+cfg.width+'px;" onselectstart="return false;">'),cfg.control&&(po.push('<div class="calendar-control" data-calendar-els="control" style="height:'+cfg.item_height+"px;line-height:"+cfg.item_height+'px;">'),po.push('<a class="date-move-left" data-calendar-move="left" style="width:'+cfg.item_width+'px;">'+cfg.control.left+"</a>"),po.push('<div class="date-display" data-calendar-els="control-display"></div>'),po.push('<a class="date-move-right" data-calendar-move="right" style="width:'+cfg.item_width+'px;">'+cfg.control.right+"</a>"),po.push("</div>")),po.push('<div class="calendar-body" data-calendar-els="body"></div>'),po.push("</div>"),po.join("")},this.set_display=function(){cfg.control&&this.els["control-display"].html(U.date(cfg.display_date,{"return":cfg.control.display}))},this.print_day=function(now_date){var loop_date,i,k,dot_date=U.date(now_date),po=[],month_start_date=new Date(dot_date.getFullYear(),dot_date.getMonth(),1,12),table_start_date=function(){var day=month_start_date.getDay();return 0==day&&(day=7),U.date(month_start_date,{add:{d:-day}})}(),this_month=dot_date.getMonth(),this_date=dot_date.getDate(),item_styles=["width:"+cfg.item_width+"px","height:"+cfg.item_height+"px","line-height:"+(cfg.item_height-2*cfg.item_padding)+"px","padding:"+cfg.item_padding+"px"];for(po.push('<table data-calendar-table="day" cellpadding="0" cellspacing="0">'),po.push("<thead>"),po.push("<tr>"),k=0;7>k;)po.push('<td class="calendar-col-'+k+'">'),po.push(ax5.info.week_names[k].label),po.push("</td>"),k++;for(po.push("</tr>"),po.push("</thead>"),po.push("<tbody>"),loop_date=table_start_date,i=0;6>i;){for(po.push("<tr>"),k=0;7>k;)po.push('<td class="calendar-col-'+k+'" style="'+item_styles.join(";")+';">'),po.push('<a class="calendar-item-date '+function(){return loop_date.getMonth()==this_month?loop_date.getDate()==this_date?"focus":"live":""}()+'" data-calendar-item-date="'+U.date(loop_date,{"return":cfg.date_format})+'">'+loop_date.getDate()+"</a>"),po.push("</td>"),k++,loop_date=U.date(loop_date,{add:{d:1}});po.push("</tr>"),i++}po.push("</tbody>"),po.push("</table>"),this.els.body.html(po.join("")),this.els.body.find("[data-calendar-item-date]").on(cfg.click_event_name,function(e){this.onclick(e||window.event)}.bind(this)),this.set_display()},this.onclick=function(e,target,value){target=axd.parent(e.target,function(target){return ax5.dom.attr(target,"data-calendar-item-date")?!0:void 0}),target&&(value=axd.attr(target,"data-calendar-item-date"),this.config.onclick&&this.config.onclick.call({date:value,target:this.target.elements[0],item_target:target}))},this.move=function(e,target,value){target=axd.parent(e.target,function(target){return ax5.dom.attr(target,"data-calendar-move")?!0:void 0}),target&&(value=axd.attr(target,"data-calendar-move"),"day"==cfg.mode&&(cfg.display_date="left"==value?U.date(cfg.display_date,{add:{m:-1}}):U.date(cfg.display_date,{add:{m:1}}),this.print_day(cfg.display_date)))},this.set_display_date=function(d){cfg.display_date=U.date(d),"day"==cfg.mode?this.print_day(cfg.display_date):"month"==cfg.mode||"year"==cfg.mode}};U.is_function(ax_super)&&(ax_class.prototype=new ax_super),root.calendar=ax_class,"function"==typeof define&&define.amd&&define("_ax5_ui_calendar",[],function(){return ax_class})}(ax5.ui,ax5.ui.root);